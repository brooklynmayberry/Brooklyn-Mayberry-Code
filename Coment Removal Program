/*This is a comment removal program*/

/*implement as state machine                                                                                                                                                    
1 normal state                                                                                                                                                                  
2 inside quotes                                                                                                                                                                 
3 potential into comments                                                                                                                                                       
4 in comment                                                                                                                                                                    
5 potential out of comment                                                                                                                                                      
                                                                                                                                                                                
To run: make state                                                                                                                                                              
./state < state.c to run it on itself                                                                                                                                           
*/

#include <stdio.h>

int main(){

  char c;
  int state;
  state = 1;

  while((c = getchar()) != EOF){
    switch(state){
    case 1: /* normal state*/
      if(c == '"'){
        state = 2;
        putchar(c);
      }
      else if(c == '/'){
        state = 3;
      }
      else putchar(c);
      break;
    case 2: /* in quotes */
      putchar(c);
      if(c == '"') state = 1;
      break;
    case 3: /* maybe a comment */
      if(c == '*'){
        state = 4;
      }
      else if(c == '/'){
        putchar('/');
      }
      else if(c == '"'){
        putchar('/');
        putchar(c);
        state = 2;
      }
      else{
        state = 1;
        putchar('/');
        putchar(c);
      }
      break;
    case 4: /* inside comment */
      if(c == '*') state = 5;
      break;
    case 5: /* potentially out of comment */
      if(c == '/') state = 1;
      else if(c != '*') state = 4;
      break;
    }
  }




}
